<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Samurai Japanese Center - Kiểm tra Kaiwa</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #F9FAFB;
        }

        header {
            background-color: #1E3A8A;
            color: white;
            text-align: center;
            padding: 1.5rem;
        }

        header h1 {
            margin: 0;
            font-size: 2rem;
            font-weight: 700;
        }

        main {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        section {
            margin-bottom: 2rem;
        }

        label {
            font-weight: 500;
            display: block;
            margin-bottom: 0.5rem;
        }

        input, select, textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #D1D5DB;
            border-radius: 5px;
            font-size: 1rem;
            box-sizing: border-box;
        }

        select:disabled {
            background-color: #E5E7EB;
            cursor: not-allowed;
        }

        select:not(:disabled) {
            background-color: #FFFFFF;
            cursor: pointer;
        }

        #question-container {
            background-color: #FFFFFF;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        #current-question {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            font-weight: 500;
        }

        #question-progress {
            font-style: italic;
            color: #6B7280;
            margin-bottom: 1rem;
        }

        button {
            background-color: #10B981;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: background-color 0.3s;
            margin-right: 1rem;
            margin-top: 1rem;
        }

        button:hover {
            background-color: #059669;
        }

        button:disabled {
            background-color: #D1D5DB;
            cursor: not-allowed;
        }

        footer {
            text-align: center;
            padding: 1.5rem;
            background-color: #1E3A8A;
            color: white;
            font-size: 0.9rem;
        }

        /* Furigana styling */
        ruby {
            ruby-align: center;
        }

        rt {
            font-size: 0.6em;
            color: #555;
        }
    </style>
</head>
<body>
    <header>
        <h1>Samurai Japanese Center - Kiểm tra Kaiwa</h1>
    </header>
    <main>
        <section>
            <h2>Thông tin học viên</h2>
            <label for="student-name">Họ và Tên:</label>
            <input type="text" id="student-name" placeholder="Nhập họ và tên" required>
            <label for="student-class">Lớp:</label>
            <input type="text" id="student-class" placeholder="Nhập lớp" required>
        </section>
        <section>
            <label for="lesson-select">Chọn bài học:</label>
            <select id="lesson-select" disabled>
                <option value="">-- Chọn bài --</option>
                <option value="1">Bài 1</option>
                <option value="3">Bài 3</option>
                <option value="4">Bài 4</option>
                <option value="5">Bài 5</option>
                <option value="6">Bài 6</option>
                <option value="7">Bài 7</option>
                <option value="8">Bài 8</option>
                <option value="9">Bài 9</option>
                <option value="10">Bài 10</option>
                <option value="11">Bài 11</option>
                <option value="12">Bài 12</option>
                <option value="13">Bài 13</option>
                <option value="14">Bài 14</option>
                <option value="15">Bài 15</option>
                <option value="16">Bài 16</option>
                <option value="17">Bài 17</option>
                <option value="18">Bài 18</option>
                <option value="19">Bài 19</option>
                <option value="20">Bài 20</option>
                <option value="21">Bài 21</option>
                <option value="22">Bài 22</option>
                <option value="23">Bài 23</option>
                <option value="24">Bài 24</option>
                <option value="25">Bài 25</option>
                <option value="26">Bài 26</option>
                <option value="27">Bài 27</option>
                <option value="28">Bài 28</option>
                <option value="29">Bài 29</option>
                <option value="30">Bài 30</option>
                <option value="31">Bài 31</option>
                <option value="32">Bài 32</option>
                <option value="33">Bài 33</option>
                <option value="34">Bài 34</option>
                <option value="35">Bài 35</option>
                <option value="36">Bài 36</option>
                <option value="37">Bài 37</option>
                <option value="38">Bài 38</option>
                <option value="39">Bài 39</option>
                <option value="40">Bài 40</option>
                <option value="41">Bài 41</option>
                <option value="42">Bài 42</option>
                <option value="43">Bài 43</option>
                <option value="44">Bài 44</option>
                <option value="45">Bài 45</option>
                <option value="46">Bài 46</option>
                <option value="47">Bài 47</option>
                <option value="48">Bài 48</option>
                <option value="49">Bài 49</option>
                <option value="50">Bài 50</option>
            </select>
            <div>
                <button id="start-test-btn" aria-label="Bắt đầu kiểm tra">Bắt đầu kiểm tra</button>
                <button id="show-history-btn" aria-label="Xem lịch sử kiểm tra">Lịch sử kiểm tra</button>
            </div>
        </section>
        <section id="question-container" style="display: none;">
            <h2>Câu hỏi</h2>
            <div id="current-question"></div>
            <div id="question-progress"></div>
            <textarea id="answer-input" placeholder="Nhập câu trả lời của bạn..."></textarea>
            <div id="answer-buttons">
                <button id="check-answer-btn" aria-label="Gửi câu trả lời">Trả lời</button>
            </div>
            <button id="complete-button" aria-label="Hoàn thành bài kiểm tra" style="display: none;">Hoàn thành</button>
        </section>
    </main>
    <footer>
        <p>Tài liệu kiểm tra © 2025 thiết kế bởi Thuận</p>
    </footer>

    <!-- Firebase CDN -->
    <script type="module">
        // Import Firebase modular SDK
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
        import { getFirestore, collection, addDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAfy4QMD9_7PyFHpInNdKDRWuW4AYCtLJ4",
            authDomain: "history-e4633.firebaseapp.com",
            projectId: "history-e4633",
            storageBucket: "history-e4633.firebasestorage.app",
            messagingSenderId: "331974436893",
            appId: "1:331974436893:web:10c3c6adf7b66d2b5fbef4",
            measurementId: "G-DC055090BW"
        };

        // Initialize Firebase
        let db = null;
        try {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
        } catch (error) {
            console.error("Lỗi khi khởi tạo Firebase:", error);
            alert("Không thể kết nối với cơ sở dữ liệu. Vui lòng kiểm tra kết nối mạng hoặc cấu hình Firebase!");
        }

        // Questions data with furigana for all lessons
        const questions = {
            1: [
                { text: "お名前は何ですか？", furigana: [] },
                { text: "おいくつですか？", furigana: [] },
                { text: "あなたは日本人ですか？", furigana: [["日本人", "にほんじん"]] },
                { text: "あなたの国は何ですか？", furigana: [["国", "くに"]] },
                { text: "お父さんはおいくつですか？", furigana: [["お父さん", "おとうさん"]] },
                { text: "あなたは学生ですか？", furigana: [["学生", "がくせい"]] },
                { text: "あなたは会社員ですか？", furigana: [["会社員", "かいしゃいん"]] },
                { text: "あなたは先生ですか？", furigana: [["先生", "せんせい"]] }
            ],
            3: [
                { text: "お家はどちらですか？", furigana: [["お家", "おうち"]] },
                { text: "あなたのボールペンはいくらですか？", furigana: [] },
                { text: "会社はどちらですか？", furigana: [["会社", "かいしゃ"]] },
                { text: "学校はどこですか？", furigana: [["学校", "がっこう"]] },
                { text: "あなたの家は１階ですか？", furigana: [["家", "いえ"], ["１階", "いっかい"]] },
                { text: "駅はどこですか？", furigana: [["駅", "えき"]] }
            ],
            4: [
                { text: "今何時ですか？", furigana: [["何時", "なんじ"]] },
                { text: "あなたの誕生日はいつですか？", furigana: [["誕生日", "たんじょうび"]] },
                { text: "会社は何時からですか？", furigana: [["会社", "かいしゃ"], ["何時", "なんじ"]] },
                { text: "あなたは朝何時に起きますか？", furigana: [["朝", "あさ"], ["何時", "なんじ"]] },
                { text: "きのう何時に寝ましたか？", furigana: [["何時", "なんじ"]] },
                { text: "サムライセンターは何時から何時までですか？", furigana: [["何時", "なんじ"], ["何時", "なんじ"]] },
                { text: "日曜日に何時に来ますか？", furigana: [["日曜日", "にちようび"], ["何時", "なんじ"]] },
                { text: "授業は何時に終わりますか？", furigana: [["授業", "じゅぎょう"], ["何時", "なんじ"]] },
                { text: "きのう何時に家に帰りましたか？", furigana: [["何時", "なんじ"], ["家", "いえ"]] },
                { text: "お店は何時から何時までですか？", furigana: [["お店", "おみせ"], ["何時", "なんじ"], ["何時", "なんじ"]] },
                { text: "サムライセンターの授業は何時ですか？", furigana: [["授業", "じゅぎょう"], ["何時", "なんじ"]] },
                { text: "きのう何をしましたか？", furigana: [] },
                { text: "休みは何曜日ですか？", furigana: [["休み", "やすみ"], ["何曜日", "なんようび"]] }
            ],
            5: [
                { text: "どこへ行きますか？", furigana: [] },
                { text: "きのうどこへ行きましたか？", furigana: [] },
                { text: "きのう何時まで勉強しましたか？", furigana: [["何時", "なんじ"], ["勉強", "べんきょう"]] },
                { text: "朝何時から何時まで勉強しますか？", furigana: [["朝", "あさ"], ["何時", "なんじ"], ["何時", "なんじ"], ["勉強", "べんきょう"]] },
                { text: "昼から夕方まで何をしますか？", furigana: [["昼", "ひる"], ["夕方", "ゆうがた"]] }
            ],
            6: [
                { text: "あなたはタバコを吸いますか？", furigana: [] },
                { text: "ビールを飲みますか？", furigana: [] },
                { text: "いつもどこで昼ご飯を食べますか？", furigana: [["昼ご飯", "ひるごはん"]] },
                { text: "日曜日何をしますか？", furigana: [["日曜日", "にちようび"]] },
                { text: "今朝何を食べましたか？", furigana: [["今朝", "けさ"]] },
                { text: "いつも何時に朝ご飯を食べますか？", furigana: [["何時", "なんじ"], ["朝ご飯", "あさごはん"]] },
                { text: "サムライ日本語センターで何を勉強しますか？", furigana: [["日本語", "にほんご"], ["勉強", "べんきょう"]] },
                { text: "毎晩、どこで晩ごはんを食べますか？", furigana: [["毎晩", "まいばん"], ["晩ごはん", "ばんごはん"]] },
                { text: "毎晩、宿題をしますか？", furigana: [["毎晩", "まいばん"], ["宿題", "しゅくだい"]] },
                { text: "きのうの晩何時まで宿題をしましたか？", furigana: [["晩", "ばん"], ["何時", "なんじ"], ["宿題", "しゅくだい"]] },
                { text: "毎週、何曜日から何曜日まで日本語を勉強しますか？", furigana: [["毎週", "まいしゅう"], ["何曜日", "なんようび"], ["何曜日", "なんようび"], ["日本語", "にほんご"], ["勉強", "べんきょう"]] },
                { text: "毎日、何時から何時まで日本語を勉強しますか？", furigana: [["毎日", "まいにち"], ["何時", "なんじ"], ["何時", "なんじ"], ["日本語", "にほんご"], ["勉強", "べんきょう"]] }
            ],
            7: [
                { text: "もうご飯を食べましたか？", furigana: [["ご飯", "ごはん"]] },
                { text: "スプーンでご飯を食べますか？", furigana: [["ご飯", "ごはん"]] },
                { text: "誕生日にプレゼントをもらいましたか？", furigana: [["誕生日", "たんじょうび"]] },
                { text: "お母さんの誕生日に何をあげましたか？", furigana: [["お母さん", "おかあさん"], ["誕生日", "たんじょうび"]] },
                { text: "クリスマスにプレゼントをもらいましたか？", furigana: [] },
                { text: "もう６時の授業が終わりましたか？", furigana: [["授業", "じゅぎょう"]] },
                { text: "友達に電話をかけましたか？", furigana: [["友達", "ともだち"], ["電話", "でんわ"]] },
                { text: "もう昼ご飯を食べましたか？", furigana: [["昼ご飯", "ひるごはん"]] }
            ],
            8: [
                { text: "センターの授業はどうですか？", furigana: [["授業", "じゅぎょう"]] },
                { text: "ホーチミンはどんなところですか？", furigana: [] },
                { text: "お父さんはどんな人ですか？", furigana: [["お父さん", "おとうさん"], ["人", "ひと"]] },
                { text: "お父さんはやさしいですか？", furigana: [["お父さん", "おとうさん"]] },
                { text: "ITMセンターの授業にもう慣れましたか？", furigana: [["授業", "じゅぎょう"], ["慣", "な"]] },
                { text: "ベトナムはどんな国ですか？", furigana: [["国", "くに"]] },
                { text: "あなたの国はどんな国ですか？", furigana: [["国", "くに"]] },
                { text: "あなたの家はどうですか？", furigana: [["家", "いえ"]] },
                { text: "ホーチミンはどんな街ですか？", furigana: [["街", "まち"]] },
                { text: "センターの先生はやさしいですか？", furigana: [["先生", "せんせい"]] },
                { text: "あなたの学校はどうですか？", furigana: [["学校", "がっこう"]] }
            ],
            9: [
                { text: "どんなスポーツが好きですか？", furigana: [] },
                { text: "どうして日本語を勉強しますか？", furigana: [["日本語", "にほんご"], ["勉強", "べんきょう"]] },
                { text: "あなたは歌が上手ですか？", furigana: [["歌", "うた"], ["上手", "じょうず"]] },
                { text: "あなたは日本語がわかりますか？", furigana: [["日本語", "にほんご"]] },
                { text: "今、買い物がありますか？", furigana: [["買い物", "かいもの"]] },
                { text: "どんな映画が好きですか？", furigana: [["映画", "えいが"]] },
                { text: "どんな音楽が好きですか？", furigana: [["音楽", "おんがく"]] },
                { text: "サッカーが好きですか？", furigana: [] },
                { text: "どんな飲み物が好きですか？", furigana: [["飲み物", "のみもの"]] },
                { text: "どんな食べ物が好きですか？どんな食べ物が嫌いですか？", furigana: [["食べ物", "たべもの"]] },
                { text: "どんな本が好きですか？", furigana: [["本", "ほん"]] },
                { text: "家にペットがいますか？", furigana: [["家", "いえ"]] }
            ],
            10: [
                { text: "あなたの国に山がありますか？", furigana: [["国", "くに"], ["山", "やま"]] },
                { text: "どこに住んでいますか？", furigana: [["住", "す"]] },
                { text: "家に猫がいますか？", furigana: [["家", "いえ"], ["猫", "ねこ"]] },
                { text: "国にATMがありますか？", furigana: [["国", "くに"]] },
                { text: "あなたの友達はどこに住んでいますか？", furigana: [["友達", "ともだち"], ["住", "す"]] },
                { text: "学校に図書館がありますか？", furigana: [["学校", "がっこう"], ["図書館", "としょかん"]] },
                { text: "あなたの家族に誰がいますか？", furigana: [["家族", "かぞく"], ["誰", "だれ"]] },
                { text: "あなたの部屋にテレビがありますか？", furigana: [["部屋", "へや"]] },
                { text: "家に扇風機がありますか？", furigana: [["家", "いえ"], ["扇風機", "せんぷうき"]] },
                { text: "会社に誰がいますか？", furigana: [["会社", "かいしゃ"], ["誰", "だれ"]] },
                { text: "あなたの学校に図書館がありますか？", furigana: [["学校", "がっこう"], ["図書館", "としょかん"]] }
            ],
            11: [
                { text: "何時に寝ますか？", furigana: [["何時", "なんじ"]] },
                { text: "日本までどのくらい時間がかかりましたか？", furigana: [["時間", "じかん"]] },
                { text: "センターからあなたの家までバスでどのくらいかかりますか？", furigana: [["家", "いえ"]] },
                { text: "あなたの家から会社までバスでかかりますか？", furigana: [["家", "いえ"], ["会社", "かいしゃ"]] },
                { text: "どのくらい日本語を勉強できますか？", furigana: [["日本語", "にほんご"], ["勉強", "べんきょう"]] },
                { text: "家に部屋がいくつありますか？", furigana: [["家", "いえ"], ["部屋", "へや"]] },
                { text: "あなたのクラスは何人ですか？", furigana: [["何人", "なんにん"]] },
                { text: "朝、何をしますか？", furigana: [["朝", "あさ"]] },
                { text: "クラスに日本人がいますか？", furigana: [["日本人", "にほんじん"]] },
                { text: "クラスに外国人がいますか？", furigana: [["外国人", "がいこくじん"]] }
            ],
            12: [
                { text: "日本はどうでしたか？", furigana: [] },
                { text: "ベトナムでいつが好きですか？", furigana: [] },
                { text: "日本とベトナム、どちらが好きですか？", furigana: [] },
                { text: "クラスで誰が一番やさしいですか？", furigana: [["誰", "だれ"], ["一番", "いちばん"]] },
                { text: "サッカーとテニス、どちらが好きですか？", furigana: [] },
                { text: "ベトナムで何が好きですか？", furigana: [] },
                { text: "クラスで誰が日本語が上手ですか？", furigana: [["誰", "だれ"], ["日本語", "にほんご"], ["上手", "じょうず"]] },
                { text: "熱いコーヒーと冷たいコーヒー、どちらが好きですか？", furigana: [["熱", "あつ"], ["冷", "つめ"]] },
                { text: "お父さんとお母さん、どちらが料理が上手ですか？", furigana: [["お父さん", "おとうさん"], ["お母さん", "おかあさん"], ["料理", "りょうり"], ["上手", "じょうず"]] },
                { text: "ベトナムで何が一番好きですか？", furigana: [["一番", "いちばん"]] },
                { text: "ベトナムで何が面白いですか？", furigana: [["面白", "おもしろ"]] },
                { text: "ベトナムでどこが好きですか？", furigana: [] }
            ],
            13: [
                { text: "日本語は面白いですか？", furigana: [["日本語", "にほんご"], ["面白", "おもしろ"]] },
                { text: "日本語と英語、どちらが面白いですか？", furigana: [["日本語", "にほんご"], ["英語", "えいご"], ["面白", "おもしろ"]] },
                { text: "今週末、何をしたいですか？", furigana: [["今週末", "こんしゅうまつ"]] },
                { text: "日本に住みたいですか？", furigana: [["住", "す"]] },
                { text: "日本へ旅行に行きたいですか？", furigana: [["旅行", "りょこう"]] },
                { text: "日本へ勉強しに行きますか？", furigana: [["勉強", "べんきょう"]] },
                { text: "誕生日に何をもらいたいですか？", furigana: [["誕生日", "たんじょうび"]] },
                { text: "サムライセンターへ日本語を勉強しに来ましたか？", furigana: [["日本語", "にほんご"], ["勉強", "べんきょう"]] },
                { text: "昼ご飯を食べにどこへ行きますか？", furigana: [["昼ご飯", "ひるごはん"]] },
                { text: "どんな人と話したいですか？", furigana: [["人", "ひと"]] }
            ],
            14: [
                { text: "今、何を持っていますか？", furigana: [] },
                { text: "日本語を勉強していますか？", furigana: [["日本語", "にほんご"], ["勉強", "べんきょう"]] },
                { text: "本を読んでいますか？", furigana: [["本", "ほん"], ["読", "よ"]] },
                { text: "あなたの家族について教えてください。", furigana: [["家族", "かぞく"]] },
                { text: "日本とベトナムの違いを教えてください。", furigana: [["違", "ちが"]] },
                { text: "あなたの趣味を教えてください。", furigana: [["趣味", "しゅみ"]] }
            ],
            15: [
                { text: "日本語を話していますか？", furigana: [["日本語", "にほんご"], ["話", "はな"]] },
                { text: "バイクを運転していますか？", furigana: [["運転", "うんてん"]] },
                { text: "パソコンを使っていますか？", furigana: [["使", "つか"]] },
                { text: "ここでタバコを吸ってもいいですか？", furigana: [] },
                { text: "ここで写真を撮ってもいいですか？", furigana: [["写真", "しゃしん"], ["撮", "と"]] },
                { text: "あなたはどこに住んでいますか？", furigana: [["住", "す"]] },
                { text: "ここでご飯を食べてもいいですか？", furigana: [["ご飯", "ごはん"]] },
                { text: "センターでお茶を飲んでもいいですか？", furigana: [["お茶", "おちゃ"], ["飲", "の"]] },
                { text: "ここで寝てもいいですか？", furigana: [] }
            ],
            16: [
                { text: "家に帰ってから何をしますか？", furigana: [["家", "いえ"], ["帰", "かえ"]] },
                { text: "きのう、ご飯を食べてから何をしましたか？", furigana: [["ご飯", "ごはん"], ["食", "た"]] },
                { text: "日本で３年住んで、ベトナムへ帰ってから何をしますか？", furigana: [["住", "す"], ["帰", "かえ"]] },
                { text: "日本の天気はどうですか？", furigana: [["天気", "てんき"]] },
                { text: "センターの授業はどうですか？", furigana: [["授業", "じゅぎょう"]] },
                { text: "ベトナムの食べ物はどうですか？", furigana: [["食べ物", "たべもの"]] },
                { text: "日本へ行って、どこへ行きたいですか？", furigana: [] }
            ],
            17: [
                { text: "センターに毎日来なければなりませんか？", furigana: [["毎日", "まいにち"], ["来", "こ"]] },
                { text: "日本に行きます。パスポートを持たなければなりませんか？", furigana: [] },
                { text: "毎朝センターに来なければなりませんか？", furigana: [["毎朝", "まいあさ"], ["来", "こ"]] },
                { text: "宿題をしなければなりませんか？", furigana: [["宿題", "しゅくだい"]] },
                { text: "お腹が痛いです。病院に行かなければなりませんか？", furigana: [["お腹", "おなか"], ["痛", "いた"], ["病院", "びょういん"]] },
                { text: "日本へ行くのにビザを取らなければならない？", furigana: [["取", "と"]] }
            ],
            18: [
                { text: "日本語で話すことができますか？", furigana: [["日本語", "にほんご"], ["話", "はな"]] },
                { text: "どんなスポーツをすることができますか？", furigana: [] },
                { text: "ピアノを弾けますか？", furigana: [["弾", "ひ"]] },
                { text: "あなたの仕事は何ですか？", furigana: [["仕事", "しごと"]] },
                { text: "ご飯を食べる前に何をしますか？", furigana: [["ご飯", "ごはん"], ["食", "た"], ["前", "まえ"]] },
                { text: "寝る前に何をしますか？", furigana: [["前", "まえ"]] },
                { text: "ベトナムで日本語を話すことができますか？", furigana: [["日本語", "にほんご"], ["話", "はな"]] },
                { text: "ベトナムで英語を話すことができますか？", furigana: [["英語", "えいご"], ["話", "はな"]] },
                { text: "お茶を飲みたいですが、どこで飲むことができますか？", furigana: [["お茶", "おちゃ"], ["飲", "の"]] },
                { text: "日本へ行くのに何をしたいですか？", furigana: [] }
            ],
            19: [
                { text: "日本の文化を勉強しましたか？", furigana: [["文化", "ぶんか"], ["勉強", "べんきょう"]] },
                { text: "日本語が上手になりましたか？", furigana: [["日本語", "にほんご"], ["上手", "じょうず"]] },
                { text: "ダイエットをしたことがありますか？", furigana: [] },
                { text: "日本に行ったことがありますか？", furigana: [] },
                { text: "日本へ行ってから何をしたいですか？", furigana: [] },
                { text: "寿司を食べたことがありますか？", furigana: [["寿司", "すし"]] },
                { text: "ベトナムでどこへ行ったことがありますか？", furigana: [] },
                { text: "ハノイに行ったことがありますか？", furigana: [] },
                { text: "センターでタバコを吸ってはいけませんか？", furigana: [] },
                { text: "友達にプレゼントをあげたことがありますか？", furigana: [["友達", "ともだち"]] }
            ],
            20: [
                { text: "日本語を話す？", furigana: [["日本語", "にほんご"], ["話", "はな"]] },
                { text: "ベトナムで何が好き？", furigana: [] },
                { text: "漢字がいくつわかる？", furigana: [["漢字", "かんじ"]] },
                { text: "ベトナムと日本、どっちが面白い？", furigana: [["面白", "おもしろ"]] },
                { text: "日本語がわかる？", furigana: [["日本語", "にほんご"]] },
                { text: "きのうは天気がどうだった？", furigana: [["天気", "てんき"]] },
                { text: "日本語が話せる？", furigana: [["日本語", "にほんご"], ["話", "はな"]] },
                { text: "ご飯を食べた？", furigana: [["ご飯", "ごはん"], ["食", "た"]] },
                { text: "明日、ビールを飲まない？", furigana: [["明日", "あした"], ["飲", "の"]] },
                { text: "今、何を持っている？", furigana: [] },
                { text: "あなたはどこに住んでいる？", furigana: [["住", "す"]] },
                { text: "きのう、何だった？", furigana: [] },
                { text: "今、何してる？", furigana: [] }
            ],
            21: [
                { text: "日本語が難しいと思いますか？", furigana: [["日本語", "にほんご"], ["難", "むずか"]] },
                { text: "日本は楽しいと思いますか？", furigana: [["楽", "たの"]] },
                { text: "日本の文化についてどう思いますか？", furigana: [["文化", "ぶんか"]] },
                { text: "ベトナムについてどう思いますか？", furigana: [] },
                { text: "ご飯を食べた後で寝ると思いますか？", furigana: [["ご飯", "ごはん"], ["食", "た"], ["後", "あと"]] },
                { text: "日本語と英語、どちらが難しいと思いますか？", furigana: [["日本語", "にほんご"], ["英語", "えいご"], ["難", "むずか"]] },
                { text: "ベトナムでどこが楽しいと思いますか？", furigana: [["楽", "たの"]] },
                { text: "寝る前に何をしますか？", furigana: [["前", "まえ"]] }
            ],
            22: [
                { text: "あなたが生まれたところはどこですか？", furigana: [["生", "う"]] },
                { text: "ほしいものは何ですか？", furigana: [] },
                { text: "今、電話をかけている人はいますか？", furigana: [["電話", "でんわ"], ["人", "ひと"]] },
                { text: "飲むお茶がありますか？", furigana: [["飲", "の"], ["お茶", "おちゃ"]] },
                { text: "レストランで食べるのと家で食べるの、どちらが好きですか？", furigana: [["家", "いえ"], ["食", "た"]] },
                { text: "初めて行った国はどこですか？", furigana: [["初", "はじ"], ["国", "くに"]] },
                { text: "今、着ている服はいつ買いましたか？", furigana: [["着", "き"], ["服", "ふく"]] },
                { text: "今までに行ったことがある国はどこですか？", furigana: [["国", "くに"]] },
                { text: "お母さんが作った料理が好きですか？", furigana: [["お母さん", "おかあさん"], ["作", "つく"], ["料理", "りょうり"]] },
                { text: "日本にいるうちに見たいものは何ですか？", furigana: [["見", "み"]] },
                { text: "好きな食べ物は何ですか？嫌いな食べ物は何ですか？", furigana: [["食", "た"], ["物", "もの"]] }
            ],
            23: [
                { text: "日本へ行って、道がわからない、どうしますか？", furigana: [["道", "みち"]] },
                { text: "忙しい時、何をしますか？", furigana: [["忙", "いそが"], ["時", "とき"]] },
                { text: "日本へ行くとき、荷物が重いですか？", furigana: [["荷物", "にもつ"], ["重", "おも"]] },
                { text: "たくさんお酒を飲むと、どうなりますか？", furigana: [["飲", "の"]] },
                { text: "センターの近くにコンビニがありますか？", furigana: [["近", "ちか"]] },
                { text: "家へ帰るとき、何で帰りますか？どのぐらいかかりますか？", furigana: [["家", "いえ"], ["帰", "かえ"]] },
                { text: "病気になったとき、薬を飲んでもいいですか？", furigana: [["病気", "びょうき"], ["薬", "くすり"], ["飲", "の"]] },
                { text: "日本語がわからないとき、どうしますか？", furigana: [["日本語", "にほんご"]] },
                { text: "電話をかけるとき何と言いますか？", furigana: [["電話", "でんわ"]] },
                { text: "忙しい時、何をしますか？", furigana: [["忙", "いそが"], ["時", "とき"]] },
                { text: "疲れたとき、どうしますか？", furigana: [["疲", "つか"]] }
            ],
            24: [
                { text: "あなたはお母さんにプレゼントをあげたいですか？", furigana: [["お母さん", "おかあさん"]] },
                { text: "お金がないとき、誰かに借りますか？", furigana: [["お金", "おかね"], ["誰", "だれ"], ["借", "か"]] },
                { text: "あなたは誕生日にお母さんに何をしてあげますか？", furigana: [["誕生日", "たんじょうび"], ["お母さん", "おかあさん"]] },
                { text: "誕生日にお母さんにプレゼントをもらいましたか？", furigana: [["誕生日", "たんじょうび"], ["お母さん", "おかあさん"]] },
                { text: "お母さんが疲れたとき、あなたはどこを助けてあげますか？", furigana: [["お母さん", "おかあさん"], ["疲", "つか"], ["助", "たす"]] }
            ],
            25: [
                { text: "いい天気だったら、どこへ旅行に行きたいですか？", furigana: [["天気", "てんき"], ["旅行", "りょこう"]] },
                { text: "宿題が多かったら、どうしますか？", furigana: [["宿題", "しゅくだい"], ["多", "おお"]] },
                { text: "日本語を話す仕事に就きたいですか？", furigana: [["日本語", "にほんご"], ["話", "はな"], ["仕事", "しごと"], ["就", "つ"]] },
                { text: "時間があれば、何をしたいですか？", furigana: [["時間", "じかん"]] },
                { text: "もし、お金がたくさんあったら、何をしたいですか？", furigana: [["お金", "おかね"]] },
                { text: "日本でも働きますか？", furigana: [["働", "はたら"]] },
                { text: "日本へ行ったら、どこへ行きたいですか？", furigana: [] },
                { text: "チャンスがあったら、日本へ行きたいですか？", furigana: [] },
                { text: "日本語が上手くなかったら、どうしますか？", furigana: [["日本語", "にほんご"], ["上手", "じょうず"]] },
                { text: "日本に友達がいなかったら、どうしますか？", furigana: [["友達", "ともだち"]] }
            ],
            26: [
                { text: "ベトナムに行くんですが、どんなお土産を買ったらいいですか？", furigana: [["お土産", "おみやげ"], ["買", "か"]] },
                { text: "家へ帰る時に、鍵を忘れたんですが、どうしたらいいですか？", furigana: [["家", "いえ"], ["帰", "かえ"], ["時", "とき"], ["鍵", "かぎ"], ["忘", "わす"]] },
                { text: "荷物が運べないんですが、どうしたらいいですか？", furigana: [["荷物", "にもつ"], ["運", "はこ"]] },
                { text: "日本で働きたいのはどうしてですか？【～んです】", furigana: [["働", "はたら"]] },
                { text: "今、部屋の掃除をしていますか？【～んです】", furigana: [["部屋", "へや"], ["掃除", "そうじ"]] },
                { text: "日本で靴を買ったんですが、サイズに変えてもらいたいです。どう思いますか？", furigana: [["靴", "くつ"], ["買", "か"], ["変", "か"]] },
                { text: "高いお土産がありませんから、買ってもらいたいです。どう思いますか？", furigana: [["高", "たか"], ["お土産", "おみやげ"], ["買", "か"]] }
            ],
            27: [
                { text: "日本に初めて行った時、すぐ仕事が変えられますか？", furigana: [["初", "はじ"], ["時", "とき"], ["仕事", "しごと"], ["変", "か"]] },
                { text: "日本で仕事ができますか？どんな仕事ができますか？", furigana: [["仕事", "しごと"]] },
                { text: "あなたの国から仕事が変えられますか？", furigana: [["国", "くに"], ["仕事", "しごと"], ["変", "か"]] },
                { text: "歌や絵が描けますか？【Aは～が、Bは～】", furigana: [["歌", "うた"], ["絵", "え"], ["描", "か"]] },
                { text: "歌や絵が書けますか？【Aは～が、Bは～】", furigana: [["歌", "うた"], ["絵", "え"], ["書", "か"]] }
            ],
            28: [
                { text: "ギターを弾きながら、歌を歌えますか？", furigana: [["弾", "ひ"], ["歌", "うた"]] },
                { text: "休みの日はいつも何をしていますか？", furigana: [["休", "やす"]] },
                { text: "子供の時、勉強が終わってから、よく何をしていましたか？", furigana: [["子供", "こども"], ["時", "とき"], ["勉強", "べんきょう"], ["終", "お"]] },
                { text: "週末に泳いだり、走ったりしますか？", furigana: [["週末", "しゅうまつ"], ["泳", "およ"], ["走", "はし"]] },
                { text: "日本についてどう思いますか？【～し、～し、それで～】", furigana: [] },
                { text: "どうして日本で働きたいですか？【～し、～し、それで～】", furigana: [["働", "はたら"]] }
            ],
            29: [
                { text: "部屋が汚れていますか？", furigana: [["部屋", "へや"], ["汚", "よご"]] },
                { text: "部屋が汚れていますか？", furigana: [["部屋", "へや"], ["汚", "よご"]] },
                { text: "部屋の扇風機はどうなっていますか？", furigana: [["部屋", "へや"], ["扇風機", "せんぷうき"]] },
                { text: "先生に借りた本をなくしてしまったんですが、どうしたらいいですか？", furigana: [["先生", "せんせい"], ["借", "か"], ["本", "ほん"]] },
                { text: "パスポートをなくしてしまったら、どうしたらいいですか？", furigana: [] },
                { text: "子供の時、鍵を忘れてしまったことがありますか？", furigana: [["子供", "こども"], ["時", "とき"], ["鍵", "かぎ"], ["忘", "わす"]] }
            ],
            30: [
                { text: "旅行の時、どんなことを準備しておきますか？", furigana: [["旅行", "りょこう"], ["準備", "じゅんび"]] },
                { text: "日本に行く時、どんな準備をしておいたらいいですか？", furigana: [["準備", "じゅんび"]] },
                { text: "荷物をまとめましょうか？", furigana: [["荷物", "にもつ"]] },
                { text: "あなたの部屋にベトナム国旗が貼ってありますか？", furigana: [["部屋", "へや"], ["国旗", "こっき"], ["貼", "は"]] },
                { text: "あなたの部屋にカレンダーが掛けてありますか？", furigana: [["部屋", "へや"], ["掛", "か"]] },
                { text: "部屋にパソコンが置いてありますか？", furigana: [["部屋", "へや"], ["置", "お"]] },
                { text: "この部屋に何が置いてありますか？", furigana: [["部屋", "へや"], ["置", "お"]] }
            ],
            31: [
                { text: "日本は寒いですか、暑いですか？", furigana: [["寒", "さむ"], ["暑", "あつ"]] },
                { text: "日本の食べ物は好きですか？あなたは？", furigana: [["食べ物", "たべもの"]] },
                { text: "休みの日はどこかへ行くつもりですか？", furigana: [["休", "やす"]] },
                { text: "日本へ行ってからも、勉強を続けるつもりですか？", furigana: [["勉強", "べんきょう"], ["続", "つづ"]] },
                { text: "仕事が終わって、日本へ行ったら、どんな仕事をするつもりですか？", furigana: [["仕事", "しごと"], ["終", "お"], ["仕事", "しごと"]] },
                { text: "お母さんは日本へ行こうと思っています。あなたは？", furigana: [["お母さん", "おかあさん"]] },
                { text: "日本はまだ寒いです。あなたは勉強していますか？", furigana: [["寒", "さむ"], ["勉強", "べんきょう"]] },
                { text: "レベルの高い勉強を続けていますか？", furigana: [["勉強", "べんきょう"], ["続", "つづ"]] }
            ],
            32: [
                { text: "荷物が運べないんですが、誰かに頼んだ方がいいですか？", furigana: [["荷物", "にもつ"], ["運", "はこ"], ["誰", "だれ"], ["頼", "たの"]] },
                { text: "子供の時、宿題をやって行った方がいいですか？", furigana: [["子供", "こども"], ["時", "とき"], ["宿題", "しゅくだい"]] },
                { text: "日本は初めてなんですが、どんなことに気をつけたらいいですか？", furigana: [["初", "はじ"], ["気", "き"]] },
                { text: "日本の仕事は慣れるでしょうか？", furigana: [["仕事", "しごと"], ["慣", "な"]] },
                { text: "日本の仕事はどうなると思いますか？", furigana: [["仕事", "しごと"]] }
            ],
            33: [
                { text: "「故障」はどういう意味ですか？", furigana: [["故障", "こしょう"]] },
                { text: "「使用禁止」はどういう意味ですか？", furigana: [["使用禁止", "しようきんし"]] },
                { text: "「立入禁止」はどういう nghĩaですか？", furigana: [["立入禁止", "たちいりきんし"]] },
                { text: "「無料」はどういう意味ですか？", furigana: [["無料", "むりょう"]] },
                { text: "日本ではスポーツで「練習」という言葉を使います。あなたの国ではどんな言葉を使いますか？", furigana: [["練習", "れんしゅう"], ["言葉", "ことば"], ["国", "くに"], ["使", "つか"]] },
                { text: "友達が日本に行きました。これから新しい仕事を始めるんですが、どんな言葉をかけますか？", furigana: [["友達", "ともだち"], ["新", "あたら"], ["仕事", "しごと"], ["始", "はじ"], ["言葉", "ことば"]] }
            ],
            34: [
                { text: "仕事が終わった後で、何をしていますか？", furigana: [["仕事", "しごと"], ["終", "お"], ["後", "あと"]] },
                { text: "勉強が終わった後で、何をしていますか？", furigana: [["勉強", "べんきょう"], ["終", "お"], ["後", "あと"]] },
                { text: "宿題しないで、遊んだことがありますか？", furigana: [["宿題", "しゅくだい"], ["遊", "あそ"]] },
                { text: "ご飯を食べないで、学校へ行ったことがありますか？", furigana: [["ご飯", "ごはん"], ["食", "た"], ["学校", "がっこう"]] },
                { text: "シャワーを浴びないで、寝たことがありますか？", furigana: [["浴", "あ"]] },
                { text: "あなたの国ではお正月にどんな準備をしますか？", furigana: [["国", "くに"], ["お正月", "おしょうがつ"], ["準備", "じゅんび"]] },
                { text: "朝、宿題をしていて、寝ますか？", furigana: [["朝", "あさ"], ["宿題", "しゅくだい"]] }
            ],
            35: [
                { text: "たくさんお金があれば、何をしたいですか？", furigana: [["お金", "おかね"]] },
                { text: "靴を買いたいんですが、どこの靴がいいですか？", furigana: [["靴", "くつ"], ["買", "か"]] },
                { text: "あなたの国ではお正月にどんな準備をしたらいいですか？", furigana: [["国", "くに"], ["お正月", "おしょうがつ"], ["準備", "じゅんび"]] },
                { text: "ベトナムの旅行に行くんですが、いくらお金を準備すればいいですか？", furigana: [["旅行", "りょこう"], ["お金", "おかね"], ["準備", "じゅんび"]] },
                { text: "ベトナム旅行したいんですが、どの時期がいいですか？", furigana: [["旅行", "りょこう"], ["時期", "じき"]] },
                { text: "早く仕事に就きたいんですが、どうすればいいですか？", furigana: [["早", "はや"], ["仕事", "しごと"], ["就", "つ"]] },
                { text: "お金が足りなければ、どうしますか？", furigana: [["お金", "おかね"], ["足", "た"]] }
            ],
            36: [
                { text: "もう日本の生活に慣れましたか？", furigana: [["生活", "せいかつ"], ["慣", "な"]] },
                { text: "友達と仲良く話すようにしていますか？", furigana: [["友達", "ともだち"], ["仲良", "なかよ"], ["話", "はな"]] },
                { text: "買った物を忘れないようにしていますか？", furigana: [["買", "か"], ["物", "もの"], ["忘", "わす"]] },
                { text: "早く仕事に就くように、どうすればいいですか？", furigana: [["早", "はや"], ["仕事", "しごと"], ["就", "つ"]] },
                { text: "日本のラッシュはひどいです。遅れないように、どうすればいいと思いますか？", furigana: [["遅", "おく"]] },
                { text: "日本で事故にならないように、どんなことに気をつけますか？", furigana: [["事故", "じこ"], ["気", "き"]] },
                { text: "日本で事故に遭わないように、どうすればいいと思いますか？", furigana: [["事故", "じこ"], ["遭", "あ"]] }
            ],
            37: [
                { text: "子供の時、親に怒られたことがありますか？", furigana: [["子供", "こども"], ["時", "とき"], ["親", "おや"], ["怒", "おこ"]] },
                { text: "何か親に褒められたことがありますか？", furigana: [["親", "おや"], ["褒", "ほ"]] },
                { text: "日本でパスポートを盗られたら、どうしますか？", furigana: [["盗", "ぬす"]] },
                { text: "親に悪いことを言われたことがありますか？", furigana: [["親", "おや"], ["悪", "わる"]] },
                { text: "親にいいことを言われたら、どうしますか？", furigana: [["親", "おや"]] },
                { text: "ベトナムから日本へどんな物が送られていますか？", furigana: [["物", "もの"], ["送", "おく"]] },
                { text: "日本からベトナムへどんな物が送られていますか？", furigana: [["物", "もの"], ["送", "おく"]] }
            ],
            38: [
                { text: "絵を描くのが好きですか？", furigana: [["絵", "え"], ["描", "か"]] },
                { text: "アメリカやヨーロッパに住むのが好きですか？", furigana: [["住", "す"]] },
                { text: "料理を作るのはどう思いますか？", furigana: [["料理", "りょうり"], ["作", "つく"]] },
                { text: "あなたが生まれたのはどこですか？", furigana: [["生", "う"]] },
                { text: "日本語を勉強しているのはどうしてですか？", furigana: [["日本語", "にほんご"], ["勉強", "べんきょう"]] },
                { text: "一番楽しいのは何ですか？", furigana: [["一番", "いちばん"], ["楽", "たの"]] },
                { text: "大切なのは何だと思いますか？", furigana: [["大切", "たいせつ"]] }
            ],
            39: [
                { text: "ラッシュで電車に遅れたことがありますか？", furigana: [["電車", "でんしゃ"], ["遅", "おく"]] },
                { text: "電車が遅れて仕事に遅れたことがありますか？", furigana: [["電車", "でんしゃ"], ["遅", "おく"], ["仕事", "しごと"], ["遅", "おく"]] },
                { text: "世界でタバコで死んでしまう人が多いことを知っていますか？", furigana: [["世界", "せかい"], ["死", "し"], ["人", "ひと"], ["多", "おお"], ["知", "し"]] },
                { text: "親に言えなくて、難しいときはどうしますか？", furigana: [["親", "おや"], ["難", "むずか"], ["時", "とき"]] },
                { text: "「遅刻」の意味がわからないので、誰かに教えていただけますか？", furigana: [["遅刻", "ちこく"], ["誰", "だれ"], ["教", "おし"]] },
                { text: "「地理」の意味がわからないので、教えてください。", furigana: [["地理", "ちり"], ["教", "おし"]] }
            ],
            40: [
                { text: "ベトナムの食べ物は辛いか知っていますか？", furigana: [["食べ物", "たべもの"], ["辛", "から"], ["知", "し"]] },
                { text: "ベトナムの旅行にどんな物があるか教えてください。", furigana: [["旅行", "りょこう"], ["物", "もの"], ["教", "おし"]] },
                { text: "あなたが好きな国は日本のどこにあるか知っていますか？", furigana: [["国", "くに"], ["知", "し"]] },
                { text: "初めて会った人に話しているかどうか聞くのは失礼だと思いますか？", furigana: [["初", "はじ"], ["人", "ひと"], ["話", "はな"], ["聞", "き"], ["失礼", "しつれい"]] },
                { text: "あなたの国は食べ物が辛いか教えてください。", furigana: [["国", "くに"], ["食べ物", "たべもの"], ["辛", "から"], ["教", "おし"]] },
                { text: "日本へ行ってから、どこに行ってみたいですか？", furigana: [] },
                { text: "日本で日本語を話してみたいですか？", furigana: [["日本語", "にほんご"], ["話", "はな"]] }
            ],
            41: [
                { text: "親に早く帰ってもらいたいと思いますか？", furigana: [["親", "おや"], ["早", "はや"], ["帰", "かえ"]] },
                { text: "カップが汚いので、誰かに洗ってもらいたいと思いますか？", furigana: [["汚", "よご"], ["誰", "だれ"], ["洗", "あら"]] },
                { text: "ちょっと忙しいので、誰かに手伝ってもらいたいと思いますか？", furigana: [["忙", "いそが"], ["誰", "だれ"], ["手伝", "てつだ"]] },
                { text: "誰かにお土産を食べてもらったことがありますか？", furigana: [["誰", "だれ"], ["お土産", "おみやげ"], ["食", "た"]] },
                { text: "あなたのヘルメットがなくなりました。誰かに借りたいです。どう思いますか？", furigana: [["誰", "だれ"], ["借", "か"]] },
                { text: "ベトナムの旅行で誰かに荷物を手伝ってあげますか？", furigana: [["旅行", "りょこう"], ["誰", "だれ"], ["荷物", "にもつ"], ["手伝", "てつだ"]] }
            ],
            42: [
                { text: "日本語を覚えるために、どんなことをしたらいいですか？", furigana: [["日本語", "にほんご"], ["覚", "おぼ"]] },
                { text: "安全のために、何か気をつけていますか？", furigana: [["安全", "あんぜん"], ["気", "き"]] },
                { text: "勉強のために、どこへ行きますか？", furigana: [["勉強", "べんきょう"]] },
                { text: "仕事で上手く話せるように、どんなことをすればいいですか？", furigana: [["仕事", "しごと"], ["上手", "じょうず"], ["話", "はな"]] },
                { text: "やかんはどこに置きますか？", furigana: [["置", "お"]] },
                { text: "ふろしきはどこに đặtか使いますか？", furigana: [["置", "お"], ["使", "つか"]] },
                { text: "あなたの国でバイクを買うのにいくらぐらいかかりますか？", furigana: [["国", "くに"], ["買", "か"]] }
            ],
            43: [
                { text: "ベトナムの旅行に行くなら、これから変わりそうですか？", furigana: [["旅行", "りょこう"], ["変", "か"]] },
                { text: "楽しそうですね。何かいいことがあったんですか？", furigana: [["楽", "たの"]] },
                { text: "コーヒーを買ってきてくれませんか？", furigana: [["買", "か"]] }
            ],
            44: [
                { text: "お酒を飲みすぎたことがありますか？", furigana: [["飲", "の"]] },
                { text: "食べすぎて、お腹が悪くなったことがありますか？", furigana: [["食", "た"], ["お腹", "おなか"], ["悪", "わる"]] },
                { text: "あなたの国の食べ物は食べやすいですか？", furigana: [["国", "くに"], ["食べ物", "たべもの"], ["食", "た"]] },
                { text: "日本の食べ物は食べにくいと思いますか？", furigana: [["食べ物", "たべもの"], ["食", "た"]] },
                { text: "誰かに食べ物を食べてもらいたいと思いますか？", furigana: [["誰", "だれ"], ["食べ物", "たべもの"], ["食", "た"]] },
                { text: "食べ物が辛すぎて、食べられません。どう思いますか？", furigana: [["食べ物", "たべもの"], ["辛", "から"], ["食", "た"]] },
                { text: "忙しいので、プレゼントを誰かにあげますか？", furigana: [["忙", "いそが"], ["誰", "だれ"]] }
            ],
            45: [
                { text: "ベトナムでは親が亡くなった時、誰に話しますか？", furigana: [["親", "おや"], ["亡", "な"], ["時", "とき"], ["誰", "だれ"], ["話", "はな"]] },
                { text: "日本では親が亡くなった時、誰に話しますか？", furigana: [["親", "おや"], ["亡", "な"], ["時", "とき"], ["誰", "だれ"], ["話", "はな"]] },
                { text: "病気や怪我を治すには、どうしますか？", furigana: [["病気", "びょうき"], ["怪我", "けが"], ["治", "なお"]] },
                { text: "子供の時、鍵をなくした時、誰に話したらいいですか？", furigana: [["子供", "こども"], ["時", "とき"], ["鍵", "かぎ"], ["話", "はな"]] },
                { text: "頭が痛いし、熱もあります。薬を飲んだのに、なかなか治りません。どうしますか？", furigana: [["頭", "あたま"], ["痛", "いた"], ["熱", "ねつ"], ["薬", "くすり"], ["飲", "の"], ["治", "なお"]] },
                { text: "新しい仕事があります。薬を飲んだのに、頭が治りません。どうしますか？", furigana: [["新", "あたら"], ["仕事", "しごと"], ["薬", "くすり"], ["飲", "の"], ["頭", "あたま"], ["治", "なお"]] },
                { text: "ボタンを押したのに、電気がつきません。誰に話しますか？", furigana: [["押", "お"], ["電気", "でんき"], ["誰", "だれ"], ["話", "はな"]] }
            ],
            46: [
                { text: "ご飯を食べた後で、友達に話に呼ばれました。どう思いますか？", furigana: [["ご飯", "ごはん"], ["食", "た"], ["後", "あと"], ["友達", "ともだち"], ["話", "はな"], ["呼", "よ"]] },
                { text: "日本の食べ物を食べたばかりなのに、辛いと思いましたか？", furigana: [["食べ物", "たべもの"], ["食", "た"], ["辛", "から"]] },
                { text: "サムライセンターに行ったばかりですが、何か変わったことがありましたか？", furigana: [["変", "か"]] },
                { text: "買ったばかりのスマホが壊れました。どうしますか？", furigana: [["買", "か"], ["壊", "こわ"]] }
            ],
            47: [
                { text: "あなたはクラスで勉強が上手だそうですが、本当ですか？", furigana: [["勉強", "べんきょう"], ["上手", "じょうず"]] },
                { text: "日本に行きそうですが、いつ行きますか？", furigana: [] },
                { text: "天気予報によると、今日の天気はどうなりますか？", furigana: [["天気予報", "てんきよほう"], ["今日", "きょう"], ["天気", "てんき"]] }
            ],
            48: [
                { text: "子供が泣いたら、誰に話そうと思いますか？", furigana: [["子供", "こども"], ["泣", "な"], ["誰", "だれ"], ["話", "はな"]] },
                { text: "子供が勉強をやめたいと言ったら、やめさせますか？", furigana: [["子供", "こども"], ["勉強", "べんきょう"], ["言", "い"]] },
                { text: "お母さんを泣かせたことがありますか？", furigana: [["お母さん", "おかあさん"], ["泣", "な"]] },
                { text: "お父さんをがっかりさせたことがありますか？", furigana: [["お父さん", "おとうさん"]] },
                { text: "仕事で疲れて、早く帰りたいと思いますか？", furigana: [["仕事", "しごと"], ["疲", "つか"], ["早", "はや"], ["帰", "かえ"]] }
            ],
            49: [
                { text: "お名前は何とおっしゃいますか？", furigana: [] },
                { text: "ご家族はどちらにいらっしゃいますか？", furigana: [["家族", "かぞく"]] },
                { text: "いつ日本へ行かれますか？", furigana: [] },
                { text: "よく勉強なさいますか？", furigana: [["勉強", "べんきょう"]] },
                { text: "今、どこにいらっしゃいますか？", furigana: [] },
                { text: "お酒を少し召し上がりますか？", furigana: [["召", "め"]] },
                { text: "日本の食べ物をご存じですか？", furigana: [["食べ物", "たべもの"], ["存", "ぞん"]] },
                { text: "今、勉強なさいますか？", furigana: [["勉強", "べんきょう"]] }
            ],
            50: [
                { text: "お名前は何とおっしゃいますか？", furigana: [] },
                { text: "どちらに住んでいらっしゃいますか？", furigana: [["住", "す"]] },
                { text: "日本にはどのぐらい行かれましたか？", furigana: [] },
                { text: "お仕事にいらっしゃいますか？", furigana: [["仕事", "しごと"]] }
            ]
        };

        let currentLesson = null;
        let currentQuestionIndex = 0;

        // Sanitize text to prevent XSS
        function sanitizeText(text) {
            return String(text || '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '&#39;');
        }

        // Convert text with furigana to HTML
        function textToFuriganaHTML(questionObj) {
            let text = questionObj.text;
            const furigana = questionObj.furigana || [];

            furigana.forEach(([kanji, reading]) => {
                const ruby = `<ruby>${kanji}<rt>${reading}</rt></ruby>`;
                text = text.replace(kanji, ruby);
            });

            return text;
        }

        // Check student information
        function checkStudentInfo() {
            const studentName = document.getElementById('student-name').value.trim();
            const studentClass = document.getElementById('student-class').value.trim();
            const lessonSelect = document.getElementById('lesson-select');
            const isValid = studentName && studentClass;
            lessonSelect.disabled = !isValid;
            lessonSelect.setAttribute('aria-disabled', (!isValid).toString());
        }

        // Load questions
        function loadQuestions() {
            const lessonSelect = document.getElementById("lesson-select");
            const selectedLesson = lessonSelect.value;
            if (selectedLesson && questions[selectedLesson]) {
                currentLesson = selectedLesson;
                currentQuestionIndex = 0;
            } else {
                currentLesson = null;
            }
        }

        // Display current question
        function displayCurrentQuestion() {
            const currentQuestionDiv = document.getElementById("current-question");
            const questionProgress = document.getElementById("question-progress");
            const answerButtons = document.getElementById("answer-buttons");
            const completeButton = document.getElementById("complete-button");

            if (questions[currentLesson] && currentQuestionIndex < questions[currentLesson].length) {
                const questionObj = questions[currentLesson][currentQuestionIndex];
                const questionText = typeof questionObj === 'string' ? sanitizeText(questionObj) : textToFuriganaHTML(questionObj);
                currentQuestionDiv.innerHTML = questionText;
                questionProgress.innerHTML = `Câu ${currentQuestionIndex + 1}/${questions[currentLesson].length}`;
                answerButtons.style.display = 'block';
                completeButton.style.display = 'none';
            } else {
                currentQuestionDiv.innerHTML = "Hoàn thành bài học!";
                questionProgress.innerHTML = "";
                answerButtons.style.display = 'none';
                completeButton.style.display = 'block';
            }
        }

        // Start test
        function startTest() {
            const studentName = document.getElementById('student-name').value.trim();
            const studentClass = document.getElementById('student-class').value.trim();
            const lessonSelect = document.getElementById('lesson-select').value;
            const answerInput = document.getElementById('answer-input');

            if (!studentName || !studentClass) {
                alert("Vui lòng nhập họ và tên và lớp!");
                return;
            }

            if (!lessonSelect) {
                alert("Vui lòng chọn bài học!");
                return;
            }

                            if (!questions[lessonSelect]) {
                    alert("Bài học không tồn tại hoặc chưa được tải. Vui lòng thử lại!");
                    return;
                }

                currentLesson = lessonSelect;
                currentQuestionIndex = 0;
                answerInput.value = "";
                document.getElementById('question-container').style.display = 'block';
                document.getElementById('answer-buttons').style.display = 'block';
                document.getElementById('complete-button').style.display = 'none';
                displayCurrentQuestion();
            }

            // Check answer
            async function checkAnswer() {
                const studentName = document.getElementById('student-name').value.trim();
                const studentClass = document.getElementById('student-class').value.trim();
                const answerInput = document.getElementById('answer-input').value.trim();

                if (!studentName || !studentClass) {
                    alert("Vui lòng nhập họ và tên và lớp!");
                    return;
                }

                if (answerInput === "") {
                    alert("Vui lòng nhập câu trả lời!");
                    return;
                }

                if (!db) {
                    alert("Không thể kết nối với cơ sở dữ liệu. Vui lòng thử lại sau!");
                    return;
                }

                if (!currentLesson || !questions[currentLesson] || !questions[currentLesson][currentQuestionIndex]) {
                    alert("Lỗi: Bài học hoặc câu hỏi không hợp lệ. Vui lòng chọn lại bài!");
                    return;
                }

                try {
                    const questionObj = questions[currentLesson][currentQuestionIndex];
                    const questionText = typeof questionObj === 'string' ? sanitizeText(questionObj) : questionObj.text;
                    await addDoc(collection(db, 'testHistoryKaiwa'), {
                        name: studentName,
                        class: studentClass,
                        lesson: currentLesson,
                        question: questionText,
                        answer: answerInput,
                        feedback: "",
                        timestamp: serverTimestamp()
                    });
                    if (currentQuestionIndex < questions[currentLesson].length - 1) {
                        currentQuestionIndex++;
                        document.getElementById('answer-input').value = "";
                        displayCurrentQuestion();
                    } else {
                        document.getElementById("answer-buttons").style.display = 'none';
                        document.getElementById("complete-button").style.display = 'block';
                    }
                } catch (error) {
                    console.error("Lỗi khi lưu câu trả lời:", error);
                    let errorMessage = `Đã xảy ra lỗi khi lưu câu trả lời: ${error.message}`;
                    if (error.code === 'permission-denied') {
                        errorMessage = "Không có quyền truy cập dữ liệu. Vui lòng kiểm tra cấu hình Firestore!";
                    } else if (error.code === 'unavailable') {
                        errorMessage = "Không thể kết nối với Firestore. Vui lòng kiểm tra mạng!";
                    }
                    alert(errorMessage);
                }
            }

            // Complete test
            function completeTest() {
                document.getElementById('question-container').style.display = 'none';
                document.getElementById('answer-input').value = '';
                document.getElementById('lesson-select').value = '';
                currentQuestionIndex = 0;
                currentLesson = null;
                alert('Bài kiểm tra đã hoàn thành!');
                checkStudentInfo(); // Re-check to disable lesson-select
            }

            // Show history by redirecting to history.html
            function showHistory() {
                window.location.href = 'history.html';
            }

            // Initialize event listeners
            document.addEventListener('DOMContentLoaded', function() {
                const lessonSelect = document.getElementById('lesson-select');
                const studentNameInput = document.getElementById('student-name');
                const studentClassInput = document.getElementById('student-class');
                const startTestBtn = document.getElementById('start-test-btn');
                const checkAnswerBtn = document.getElementById('check-answer-btn');
                const completeBtn = document.getElementById('complete-button');
                const showHistoryBtn = document.getElementById('show-history-btn');

                lessonSelect.addEventListener('change', loadQuestions);
                studentNameInput.addEventListener('input', checkStudentInfo);
                studentClassInput.addEventListener('input', checkStudentInfo);
                startTestBtn.addEventListener('click', startTest);
                checkAnswerBtn.addEventListener('click', checkAnswer);
                completeBtn.addEventListener('click', completeTest);
                showHistoryBtn.addEventListener('click', showHistory);

                checkStudentInfo(); // Initial check
            });
        </script>
    </body>
</html>
